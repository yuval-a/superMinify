CookieStorage=function(){var STORAGE=window.localStorage;var encrypt=window.btoa;var decrypt=window.atob;function getFullKey(domain,key){return encrypt(encodeURIComponent(domain)+":"+encodeURIComponent(key))}return{get:function(domain,key){var fullKey=getFullKey(domain,key);var $jscomp$destructuring$var0=$jscomp.makeIterator(decrypt(STORAGE.getItem(fullKey)).split(":"));var setTimestamp=$jscomp$destructuring$var0.next().value;var ttl=$jscomp$destructuring$var0.next().value;var value=$jscomp$destructuring$var0.next().value;
if(ttl>0&&Date.now()-setTimestamp>=ttl){STORAGE.removeItem(fullKey);return null}return value||null},set:function(domain,key,value,expireMillis){expireMillis=expireMillis===undefined?0:expireMillis;var fullKey=getFullKey(domain,key);var fullValue=value!==null&&expireMillis>=0?encrypt(Date.now()+":"+expireMillis+":"+encodeURIComponent(value)):null;STORAGE.setItem(fullKey,fullValue)}}}();window.localStorage.clear();
function check(actual,expected){if(expected!==actual)console.log("FAIL: expected "+expected+", got "+actual+" ...");else console.log("SUCCESS: "+expected+" === "+actual)}check(CookieStorage.get("google.com","A"),null);CookieStorage.set("google.com","A","a");check(CookieStorage.get("google.com","A"),"a");check(CookieStorage.get("kueez-ent.com","A"),null);CookieStorage.set("kueez-ent.com","A","b");check(CookieStorage.get("google.com","A"),"a");check(CookieStorage.get("kueez-ent.com","A"),"b");
CookieStorage.set("kueez-ent.com","A",null);check(CookieStorage.get("kueez-ent.com","A"),null);CookieStorage.set("kueez-ent.com","A","c",10);check(CookieStorage.get("kueez-ent.com","A"),"c");setTimeout(function(){check(CookieStorage.get("kueez-ent.com","A"),"c")},5);setTimeout(function(){check(CookieStorage.get("kueez-ent.com","A"),null)},11);CookieStorage.set("kueez-ent.com","B","bb",-1);check(CookieStorage.get("kueez-ent.com","B"),null);
